import pandas as pd

# Predicted data (updated)
predicted_data = {
    "time": [
        "2023-12-31 01:00:00", "2023-12-31 02:00:00", "2023-12-31 03:00:00", "2023-12-31 04:00:00", 
        "2023-12-31 05:00:00", "2023-12-31 06:00:00", "2023-12-31 07:00:00", "2023-12-31 08:00:00",
        "2023-12-31 09:00:00", "2023-12-31 10:00:00", "2023-12-31 11:00:00", "2023-12-31 12:00:00", 
        "2023-12-31 13:00:00", "2023-12-31 14:00:00", "2023-12-31 15:00:00", "2023-12-31 16:00:00", 
        "2023-12-31 17:00:00", "2023-12-31 18:00:00", "2023-12-31 19:00:00", "2023-12-31 20:00:00", 
        "2023-12-31 21:00:00", "2023-12-31 22:00:00", "2023-12-31 23:00:00", "2024-01-01 00:00:00"
    ],
    "temperature_2m": [
        13.65, 16.13, 15.71, 15.25, 21.27, 23.34, 25.36, 28.08, 28.48, 29.29, 29.12, 28.88, 
        29.50, 25.22, 24.41, 23.16, 23.03, 22.26, 20.27, 21.62, 20.45, 17.45, 19.64, 18.49
    ],
    "precipitation": [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    ],
    "wind_speed_10m": [
        0.03, 0.28, 0.47, 0.01, 0.51, 0.66, 0.26, 0.70, 0.84, 0.87, 0.85, 0.78, 
        -0.10, 0.62, 0.62, 0.19, 0.52, 0.63, 0.09, 0.57, 0.77, 0.41, 0.62, 0.75
    ]
}

# Actual data remains the same
actual_data = {
    "time": [
        "2023-12-31 01:00:00", "2023-12-31 02:00:00", "2023-12-31 03:00:00", "2023-12-31 04:00:00", 
        "2023-12-31 05:00:00", "2023-12-31 06:00:00", "2023-12-31 07:00:00", "2023-12-31 08:00:00",
        "2023-12-31 09:00:00", "2023-12-31 10:00:00", "2023-12-31 11:00:00", "2023-12-31 12:00:00", 
        "2023-12-31 13:00:00", "2023-12-31 14:00:00", "2023-12-31 15:00:00", "2023-12-31 16:00:00", 
        "2023-12-31 17:00:00", "2023-12-31 18:00:00", "2023-12-31 19:00:00", "2023-12-31 20:00:00", 
        "2023-12-31 21:00:00", "2023-12-31 22:00:00", "2023-12-31 23:00:00", "2024-01-01 00:00:00"
    ],
    "temperature_2m": [
        14.75, 17.76, 16.29, 16.31, 20.26, 22.97, 24.23, 26.61, 26.87, 28.04, 28.02, 28.28, 
        28.26, 21.96, 22.06, 19.92, 23.03, 21.30, 18.36, 20.55, 18.54, 16.05, 17.52, 15.28
    ],
    "precipitation": [
        0.0, 0.02, 0.0, -0.01, -0.0, 0.0, -0.0, -0.0, -0.01, -0.01, -0.02, -0.03, 
        -0.02, -0.02, -0.03, -0.02, -0.03, -0.02, -0.02, -0.01, -0.02, -0.02, -0.02, -0.01
    ],
    "wind_speed_10m": [
        0.06, 0.58, 0.57, 0.15, 0.48, 0.71, 0.35, 0.49, 0.65, 0.70, 0.84, 0.93, 
        0.15, 0.40, 0.93, 0.22, 0.47, 0.89, 0.26, 0.71, 0.84, 0.49, 0.90, 1.31
    ]
}

# Convert to DataFrame
predicted_df = pd.DataFrame(predicted_data)
actual_df = pd.DataFrame(actual_data)

# Calculate delta (difference) for each parameter
delta_temp = predicted_df['temperature_2m'] - actual_df['temperature_2m']
delta_precip = predicted_df['precipitation'] - actual_df['precipitation']
delta_wind = predicted_df['wind_speed_10m'] - actual_df['wind_speed_10m']

# Calculate Mean Absolute Error (MAE)
mae_temp = (delta_temp).abs().mean()
mae_precip = (delta_precip).abs().mean()
mae_wind = (delta_wind).abs().mean()

# Print results
for i in range(24):
    print(f"Hour {i+1}: Temperature Delta: {delta_temp[i]:.2f}°C, Precipitation Delta: {delta_precip[i]:.2f}mm, Wind Speed Delta: {delta_wind[i]:.2f} m/s")

print(f"\nMean Absolute Error (MAE):")
print(f"Temperature: {mae_temp:.2f}°C")
print(f"Precipitation: {mae_precip:.2f}mm")
print(f"Wind Speed: {mae_wind:.2f} m/s")
